<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>MCS Blockly Mission Planner</title>
  <style>
    body { font-family: sans-serif; }
    #blocklyDiv {
      height: 600px;
      width: 100%;
      border: 1px solid #ddd;
    }
    #codeArea {
      width: 100%;
      height: 200px;
      border: 1px solid #ddd;
      padding: 5px;
      box-sizing: border-box;
      white-space: pre-wrap;
      font-family: monospace;
    }
    button {
      margin: 10px 0;
      padding: 10px 15px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
  <!-- Load Blockly -->
  <script src="https://unpkg.com/blockly/blockly.min.js"></script>
</head>
<body>

  <h1>MCS Blockly Mission Planner</h1>
  <p>使用積木來組合機器人任務，然後產生對應的網路請求程式碼。</p>

  <div id="blocklyDiv"></div>

  <button onclick="showCode()">產生程式碼</button>
  <h3>產生的 JavaScript 程式碼:</h3>
  <pre id="codeArea"></pre>

  <!-- This is the Toolbox definition -->
  <xml id="toolbox" style="display: none">
    <category name="任務 (Mission)" colour="230">
      <block type="mission_start"></block>
      <block type="adapter_new_task_notification"></block>
      <block type="adapter_complete_task"></block>
      <block type="adapter_interrupt_task"></block>
      <block type="adapter_pause_task"></block>
      <block type="adapter_resume_task"></block>
      <block type="adapter_interrupt_command"></block>
    </category>
    <category name="組合命令 (Combine)" colour="20">
        <block type="adapter_combine_navigation_open_door"></block>
        <block type="adapter_combine_navigation_switch_map"></block>
        <block type="adapter_combine_navi_manual_order"></block>
        <block type="adapter_combine_navi_pickup_ui"></block>
        <block type="adapter_combine_navi_charging_ui"></block>
    </category>
    <category name="基礎命令 (Basic)" colour="200">
        <category name="導航 (Navigation)" colour="210">
          <block type="adapter_navigation"></block>
          <block type="adapter_navigation_stop"></block>
        </category>
        <category name="中層 (Middle Layer)" colour="180">
            <block type="adapter_delivery_middle_layer_control"></block>
        </category>
        <category name="地圖與定位 (Map & Location)" colour="160">
            <block type="adapter_switch_map"></block>
            <block type="adapter_apply_map"></block>
            <block type="adapter_local_locate"></block>
            <block type="adapter_global_locate"></block>
        </category>
        <category name="介面與密碼 (UI & Password)" colour="65">
            <block type="adapter_pickup_ui"></block>
            <block type="adapter_charging_ui"></block>
            <block type="adapter_pass_opt_password"></block>
        </category>
    </category>
    <sep></sep>
    <category name="資料 (Data)" colour="290">
        <block type="data_location"></block>
        <block type="data_door"></block>
        <block type="data_map"></block>
        <block type="data_order"></block>
    </category>
    <category name="列表 (Lists)" colour="%{BKY_LISTS_HUE}">
      <block type="lists_create_with">
        <mutation items="2"></mutation>
      </block>
      <block type="lists_create_with"></block>
      <block type="lists_repeat">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="lists_length"></block>
      <block type="lists_isEmpty"></block>
      <block type="lists_indexOf">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_getIndex">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_setIndex">
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_getSublist">
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_split">
        <value name="DELIM">
          <shadow type="text">
            <field name="TEXT">,</field>
          </shadow>
        </value>
      </block>
      <block type="lists_sort"></block>
    </category>
  </xml>

  <!-- Custom Blocks and Code Generator -->
  <script src="js/custom_blocks.js"></script>
  <script src="js/code_generator.js"></script>
  <script src="js/main.js"></script>

</body>
</html>
